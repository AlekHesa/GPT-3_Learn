<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <title>Summary</title>
</head>
<body>
      <!--Navbar-->
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-center" id="navbarNavAltMarkup">
            <div class="navbar-nav">
              <a class="nav-link"  href="main.html">Main</a>
              <a class="nav-link " href="chatbot.html">Chatbot</a>
              <a class="nav-link active" aria-current="page" href="summary.html">Code Generator</a>
            </div>
          </div>
        </div>
      </nav>    

       <!--End of Navbar-->

       <section>
        <div class="container py-3 mt-3 ">
          
       <form id="getApiKey">
        <div class="input-group mb-3">
          <input type="password" class="form-control" placeholder="API KEY" aria-label="API KEY" aria-describedby="button-addon2">
          <button class="btn btn-outline-secondary" type="submit" id="button-addon2"  onclick="getApiKey()">Proceed</button>
        </div>
       </form>
        
        </div>
      </section>

  <form id="summary-form">
    <label for="text-input">Text:</label>
    <br>
    <textarea id="text-input" name="text-input" rows="10" cols="50"></textarea>
    <br>
    <button type="submit" onclick="getSummary()">Get Summary</button>
  </form>
  <div id="summary-container"></div>

  <script>
    
    async function getApiKey() {
            const response = await fetch('http://127.0.0.1:8000/GPT3', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                key: 'YOUR_API_KEY'
              })
            });
          
            const data = await response.json();
            return data.api_key;
          }

    async function getSummary(text) {
      const apiKey = await getApiKey();

      const response = await fetch('http://127.0.0.1:8000/GPT3/Summary', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${apiKey}`
        },
        body: JSON.stringify({
          text: text
        })
      });

      const data = await response.json();
      return data.summary;
    }

    const summaryForm = document.getElementById('summary-form');
    const summaryContainer = document.getElementById('summary-container');

    summaryForm.addEventListener('submit', async (event) => {
      event.preventDefault();

      const textInput = document.getElementById('text-input');
      const text = textInput.value;

      const summary = await getSummary(text);

      summaryContainer.textContent = summary;
    });
  </script>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

</html>
